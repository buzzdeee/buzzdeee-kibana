# This file is maintained via Puppet
#
#
# Kibana is served by a back end server. This controls which port to use.
# server.port: 5601
<% if @bundled_plugin_ids -%>
  <%- if @server_port -%>
port: <%= @server_port %>
  <%- end -%>
<% else -%>
  <%- if @server_port -%>
server.port: <%= @server_port %>
  <%- end -%>
<% end -%>

# The host to bind the server to.
# server.host: "0.0.0.0"
<% if @bundled_plugin_ids -%>
  <%- if @server_host -%>
host: "<%= @server_host %>"
  <%- end -%>
<% else -%>
  <%- if @server_host -%>
server.host: "<%= @server_host %>"
  <%- end -%>
<% end -%>

# If you are running kibana behind a proxy, and want to mount it at a path,
# specify that path here. The basePath can't end in a slash.
# server.basePath: ""
<% if @server_basepath -%>
server.basePath: "<%= @server_basepath %>"
<% end -%>

# The Elasticsearch instance to use for all your queries.
# elasticsearch.url: "http://localhost:9200"
<% if @bundled_plugin_ids -%>
  <%- if @elasticsearch_url -%>
elasticsearch_url: "<%= @elasticsearch_url %>"
  <%- end -%>
<% else -%>
  <%- if @elasticsearch_url -%>
elasticsearch.url: "<%= @elasticsearch_url %>"
  <%- end -%>
<% end -%>

# preserve_elasticsearch_host true will send the hostname specified in `elasticsearch`. If you set it to false,
# then the host you use to connect to *this* Kibana instance will be sent.
# elasticsearch.preserveHost: true
<% if @bundled_plugin_ids -%>
  <%- if @elasticsearch_preservehost -%>
elasticsearch_preserve_host: <%= @elasticsearch_preservehost %>
  <%- end -%>
<% else -%>
  <%- if @elasticsearch_preservehost -%>
elasticsearch.preserveHost: <%= @elasticsearch_preservehost %>
  <%- end -%>
<% end -%>

# Kibana uses an index in Elasticsearch to store saved searches, visualizations
# and dashboards. It will create a new index if it doesn't already exist.
# kibana.index: ".kibana"
<% if @bundled_plugin_ids -%>
kibana_index: <%= @kibana_index %>
<% else -%>
kibana.index: <%= @kibana_index %>
<% end -%>

# The default application to load.
# kibana.defaultAppId: "discover"
<% if @bundled_plugin_ids -%>
  <%- if @kibana_defaultappid -%>
default_app_id: <%= @kibana_defaultappid %>
  <%- end -%>
<% else -%>
  <%- if @kibana_defaultappid -%>
kibana.defaultAppId: <%= @kibana_defaultappid %>
  <%- end -%>
<% end -%>

# If your Elasticsearch is protected with basic auth, these are the user credentials
# used by the Kibana server to perform maintenance on the kibana_index at startup. Your Kibana
# users will still need to authenticate with Elasticsearch (which is proxied through
# the Kibana server)
# elasticsearch.username: "user"
# elasticsearch.password: "pass"
<% if @elasticsearch_username -%>
elasticsearch.username: <%= @elasticsearch_username %>
<% end -%>
<% if @elasticsearch_password -%>
elasticsearch.password: <%= @elasticsearch_password %>
<% end -%>

# SSL for outgoing requests from the Kibana Server to the browser (PEM formatted)
# server.ssl.cert: /path/to/your/server.crt
# server.ssl.key: /path/to/your/server.key
<% if @server_ssl_cert -%>
server.ssl.cert: <%= @server_ssl_cert %>
<% end -%>
<% if @server_ssl_key -%>
server.ssl.key: <%= @server_ssl_key %>
<% end -%>

# Optional setting to validate that your Elasticsearch backend uses the same key files (PEM formatted)
# elasticsearch.ssl.cert: /path/to/your/client.crt
# elasticsearch.ssl.key: /path/to/your/client.key
<% if @elasticsearch_ssl_cert -%>
elasticsearch.ssl.cert: <%= @elasticsearch_ssl_cert %>
<% end -%>
<% if @elasticsearch_ssl_key -%>
elasticsearch.ssl.key: <%= elasticsearch_ssl_key %>
<% end -%>

# If you need to provide a CA certificate for your Elasticsearch instance, put
# the path of the pem file here.
# elasticsearch.ssl.ca: /path/to/your/CA.pem
<% if @elasticsearch_ssl_ca -%>
elasticsearch.ssl.ca: <%= @elasticsearch_ssl_ca %>
<% end -%>

# Set to false to have a complete disregard for the validity of the SSL
# certificate.
# elasticsearch.ssl.verify: true
<% if @bundled_plugin_ids %>
  <%- if @elasticsearch_ssl_verify -%>
verify_ssl: <%= @elasticsearch_ssl_verify %>
  <%- end -%>
<% else -%>
  <%- if @elasticsearch_ssl_verify -%>
elasticsearch.ssl.verify: <%= @elasticsearch_ssl_verify %>
  <%- end -%>
<% end -%>

# Time in milliseconds to wait for elasticsearch to respond to pings, defaults to
# request_timeout setting
# elasticsearch.pingTimeout: 1500
<% if @elasticsearch_pingtimeout -%>
elasticsearch.pingTimeout: <%= @elasticsearch_pingtimeout %>
<% end -%>

# Time in milliseconds to wait for responses from the back end or elasticsearch.
# This must be > 0
# elasticsearch.requestTimeout: 300000
<% if @bundled_plugin_ids %>
  <%- if @elasticsearch_requesttimeout -%>
request_timeout: <%= @elasticsearch_requesttimeout %>
  <%- end -%>
<% else -%>
  <%- if @elasticsearch_requesttimeout -%>
elasticsearch.requestTimeout: <%= @elasticsearch_requesttimeout %>
  <%- end -%>
<% end -%>

# Time in milliseconds for Elasticsearch to wait for responses from shards.
# Set to 0 to disable.
# elasticsearch.shardTimeout: 0
<% if @bundled_plugin_ids %>
  <%- if @elasticsearch_shardtimeout -%>
shard_timeout: <%= @elasticsearch_shardtimeout %>
  <%- end -%>
<% else -%>
  <%- if @elasticsearch_shardtimeout -%>
elasticsearch.shardTimeout: <%= @elasticsearch_shardtimeout %>
  <%- end -%>
<% end -%>

# Time in milliseconds to wait for Elasticsearch at Kibana startup before retrying
# elasticsearch.startupTimeout: 5000
<% if @elasticsearch_startuptimeout -%>
elasticsearch.startupTimeout: <%= @elasticsearch_startuptimeout %>
<% end -%>

# Set the path to where you would like the process id file to be created.
# pid.file: /var/run/kibana.pid
<% if @pid_file -%>
pid.file: <%= @pid_file %>
<% end -%>

# If you would like to send the log output to a file you can set the path below.
# logging.dest: stdout
<% if @logging_dest -%>
logging.dest: <%= @logging_dest %>
<% end -%>

# Set this to true to suppress all logging output.
# logging.silent: false
<% if @logging_silent -%>
logging.silent: <%= @logging_silent %>
<% end -%>

# Set this to true to suppress all logging output except for error messages.
# logging.quiet: false
<% if @logging_quiet -%>
logging.quiet: <%= @logging_quiet %>
<% end -%>

# Set this to true to log all events, including system usage information and all requests.
# logging.verbose: false
<% if @logging_verbose -%>
logging.verbose: <%= @logging_verbose %>
<% end -%>

<% if @bundled_plugin_ids %>
# Plugins that are included in the build, and no longer found in the plugins/ folder
bundled_plugin_ids:
 - plugins/dashboard/index
 - plugins/discover/index
 - plugins/doc/index
 - plugins/kibana/index
 - plugins/markdown_vis/index
 - plugins/metric_vis/index
 - plugins/settings/index
 - plugins/table_vis/index
 - plugins/vis_types/index
 - plugins/visualize/index
<% end -%>
